name: Windows - LiteManager

on: workflow_dispatch

jobs:
  build:
    name: Start Building...
    runs-on: windows-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Downloading & installing Essentials
        run: cmd /c Scripts\Downloads.bat

      - name: Extract LiteManager ID and Settings
        run: |
          # Query key cha để tìm subkey phiên bản và tất cả values (bao gồm ID)
          reg query "HKEY_LOCAL_MACHINE\SYSTEM\LiteManager" /s > lite_settings.txt
          type lite_settings.txt  # Echo output registry ra log
          
          # Kiểm tra Config.xml cho ID (điều chỉnh path nếu cài ở Program Files (x86))
          if exist "C:\Program Files\LiteManager Pro - Server\Config.xml" (
            type "C:\Program Files\LiteManager Pro - Server\Config.xml"
          ) else if exist "C:\Program Files (x86)\LiteManager Pro - Server\Config.xml" (
            type "C:\Program Files (x86)\LiteManager Pro - Server\Config.xml"
          ) else (
            echo Config.xml not found in default paths.
          )

      - name: Connect to LiteManager
        run: cmd /c Scripts\show.bat

      - name: Time Counter
        run: cmd /c Scripts\loop.bat
